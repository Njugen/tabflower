import React, { Fragment, Component } from 'react';


/* Import Modal */

import Modal from "./components/utils/modal";

/* Import Routes */
import RouteList from './components/routes/routeList';

/* Import Sidebars */
import MainSidebar from './components/sidebars/mainSidebar/mainSidebar';

/* Import Utilities */
import FullWidthLoadbar from './components/utils/fullWidthLoadbar';

/* Import Footer */
import ViewFooter from './components/views/components/viewFooter';



/* Import CSS generated by create-react-app */
import './styles/react-generated/App.css';

/* Import Tabeon app specific CSS */
import './styles/tabeon/style.css';
import { ReactDOM } from 'react-dom';



class App extends Component{
  state = {
    currentView: {},
    mainSidebar: {},
    refreshFactor: 0
  };

 
  updateState = (newProps, showLoadbar, callback) => {
    /* 
      Used to update the App state itself. This function works the same way as this.setState(), 
      but also increases the refreshFactor (the FullWidthLoadbar uses this to determine whether to launch the loadbar
        or not)
    */
    let newState = {
      ...newProps
    }

    if(showLoadbar && showLoadbar === true){
      let { refreshFactor } = this.state;
      refreshFactor++;

      newState.refreshFactor = refreshFactor;
    }

    this.setState(newState, callback);
  }
  
  handleNavigation = (viewProps) => {

    this.updateState(
      {
        currentView: viewProps
      },
      true
    )
  }

  handleMainSidebarClick = (sidebarProps) => {
    this.updateState(
      {
        mainSidebar: sidebarProps,
      
      },
      false
    )
  }

  render = () => {
    return (
      <Fragment>
       
        <div className="container-fluid">
        <Modal></Modal>
          <div className="row">
            <MainSidebar onMainSidebarClick={(raisedProps) => this.handleMainSidebarClick(raisedProps)} />
            <div className="col-10 py-2" id="tabeon-view-container">
                <RouteList onNavigation={(raisedProps) => this.handleNavigation(raisedProps)} />
                <ViewFooter />
            </div>
          </div>
          
        </div>
        <FullWidthLoadbar refreshFactor={this.state.refreshFactor} />
      </Fragment>
    );
  }

}

export default App;
